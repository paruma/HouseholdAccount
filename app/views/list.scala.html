@import services._
@import java.util._
@(items: Seq[Entry])

<html>
<head>
    <title>ホーム - 家計簿</title>
</head>
<body>
<h1>家計簿</h1>
<section>
    <table>
        <thead>
            <th>名前</th>
            <th>値段</th>
            <th>日にち</th>
        </tr>
        </thead>
        <tbody>
        @items.map { entry =>
        <tr>
            <td><a href="@controllers.routes.HomeController.edit(entry.id.get)">@{entry.name}</a></td>
            <td>@{entry.price}円</td>
            <td>@{entry.date}</td>
        </tr>
        }
        </tbody>
    </table>

    <p><a href="@controllers.routes.HomeController.register()">登録</a></p>
    @{
    val currentYear = Calendar.getInstance().get(Calendar.YEAR)
    val currentMonth = Calendar.getInstance().get(Calendar.MONTH) + 1
    val currentYearItems = items.filter{ entry=>
    val cal = Calendar.getInstance
    cal.setTime(entry.date)
    cal.get(Calendar.YEAR) == currentYear
    }
    val currentMonthItems = currentYearItems.filter{ entry=>
    val cal = Calendar.getInstance
    cal.setTime(entry.date)
    cal.get(Calendar.MONTH)+1 == currentMonth
    }
    <p>
        {currentYear}年の合計: {currentYearItems.map(entry => entry.price).sum}円
    </p>
    <p>
        {currentYear}年{currentMonth}月の合計: {currentMonthItems.map(entry => entry.price).sum}円
    </p>

    }
</section>

</body>
</html>